$(window).load(function(){$("#wrapper").fadeIn(500);$("#footer").fadeIn(500);$("#jswarn").hide();$("#installsteps").fadeIn(500);$("input").attr("checked",false);});function step_ahead(){var i;$("#progressbar>span").removeClass("step_yap").addClass("step_nope");for(i=1;i<step+1;i++){$evalstring="$('#progressbar>span:eq("+(i-1)+")').addClass('step_yap');";eval($evalstring);}step++;}function step_back(){var target;switch(current){case 25:target="20_gpl";break;case 28:target="25_system_requirements";break;case 30:target="28_timezone";break;case 40:target="28_timezone";break;case 45:target="40_permissions";break;case 50:target="40_permissions";break;case 60:target="50_enter_access_data";break;case 70:target="60_db_select_mysql";break;}step=step-2;step_ahead();$("#installsteps").slideUp(500,function(){$.post("steps/"+target+".php",{hostname:hostname,database:database,username:username,password:password,prefix:prefix,language:language,timezone:timezone},function(data){$("#installsteps").html(data).slideDown(500);});});}function lang_selected(lang){step_ahead();language=lang;$("#installsteps").slideUp(500,function(){target="20_gpl";$.post("steps/"+target+".php",{language:language},function(data){$("#installsteps").html(data).slideDown(500);});});}function gpl_agreed(){$("#installsteps button.proceed").fadeIn(500);}function gpl_proceed(){step_ahead();$("#installsteps").slideUp(500,function(){target="25_system_requirements";$.post("steps/"+target+".php",{language:language},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}function check_system_requirements(){$.post("processor.php",{axAction:"checkRequirements"},function(data){eval(data);});}function resetRequirementsIndicators(){$("div.sp_phpversion").removeClass("fail");$("div.sp_magicquotes").removeClass("fail");$("div.sp_mysql").removeClass("fail");$("div.sp_memory").removeClass("fail");$("div.sp_phpversion").addClass("ok");$("div.sp_magicquotes").addClass("ok");$("div.sp_mysql").addClass("ok");$("div.sp_memory").addClass("ok");}function system_requirements_proceed(){step_ahead();$("#installsteps").slideUp(500,function(){target="28_timezone";$.post("steps/"+target+".php",{language:language},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}function timezone_proceed(){step_ahead();timezone=$("#timezone").val();$("#installsteps").slideUp(500,function(){target="40_permissions";$.post("steps/"+target+".php",{language:language,timezone:timezone},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}function check_permissions(){$.post("processor.php",{axAction:"checkRights"},function(data){resetPermissionIndicators();eval(data);});}function resetPermissionIndicators(){$("span.ch_autoconf").removeClass("fail");$("span.ch_logfile").removeClass("fail");$("span.ch_temporary").removeClass("fail");$("span.ch_autoconf").addClass("ok");$("span.ch_logfile").addClass("ok");$("span.ch_temporary").addClass("ok");$("span.ch_correctit").fadeOut(500);}function cp_proceed(){step_ahead();$("#installsteps").slideUp(500,function(){target="50_enter_access_data";$.post("steps/"+target+".php",{language:language},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}function host_proceed(){hostname=$("#host").val();username=$("#user").val();password=$("#pass").val();if(username==""){if(language=="en"){caution="You must enter a user name!";}else{caution="Sie müssen einen Benutzer-Namen eingeben!";}$("#caution").html(caution);}else{step_ahead();$("#installsteps").slideUp(500,function(){target="60_db_select_mysql";$.post("steps/"+target+".php",{hostname:hostname,username:username,password:password,language:language,timezone:timezone},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}}function db_check(){database=$("#db_names").val();create_database=$("#db_create").val();prefix=$("#prefix").val();databaseGiven=$("#db_names").is("select")?database!="0":database!="";if(!databaseGiven&&create_database==""){if(language=="en"){$("#db_select_label").html("You have to choose one of these databases!");$("#db_select_label").html("You have to choose either one of these ...");$("#db_create_label").html("... or create a new one!");}else{$("#db_select_label").html("Sie müssen hier eine Datenbank auswählen!");$("#db_select_label").html("Sie müssen entweder hier eine Datenbank auswählen ...");$("#db_create_label").html("... oder hier eine neue erstellen!");}$("#db_select_label").addClass("arrow");$("#db_create_label").addClass("arrow");}else{$("#installsteps").slideUp(500,function(){$.post("steps/"+target+".php",{hostname:hostname,database:database,username:username,password:password,prefix:prefix,language:language,timezone:timezone,create_database:create_database,redirect:true},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});});}}function db_proceed(){database=$("#db_names").val();create_database=$("#db_create").val();prefix=$("#prefix").val();if(create_database!=""){database=create_database;new_database=1;}target="70_write_conf";step_ahead();$.post("steps/"+target+".php",{hostname:hostname,database:database,username:username,password:password,prefix:prefix,language:language,timezone:timezone},function(data){$("#installsteps").html(data);$("td.use_db").html(database);$("td.use_host").html(hostname);$("td.use_prefix").html(prefix);$("#installsteps").slideDown(500);});}function install(){if(new_database==1){create_db();}else{write_config();}}function create_db(){$.post("processor.php",{axAction:"make_database",hostname:hostname,database:database,username:username,password:password,prefix:prefix,language:language,timezone:timezone},function(data){if(data=="1"){write_config();}else{target="db_error";$.post("steps/"+target+".php",{language:language},function(data){$("#installsteps").html(data);$("#installsteps").slideDown(500);});}});}function write_config(){step_ahead();$.post("processor.php",{axAction:"write_config",hostname:hostname,database:database,username:username,password:password,prefix:prefix,language:language,timezone:timezone},function(data){$("#wrapper").fadeOut(500);$("#footer").fadeOut(500,function(){window.location.href="install.php?accept=1&timezone="+timezone;});});}